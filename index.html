<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <title>PINE Tycoon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Підключаємо твій CSS з анімаційними кнопками -->
    <link rel="stylesheet" href="style.css">

    <style>
      /* Робимо сторінку на всю висоту + footer внизу */
      html, body {
        height: 100%;
        margin: 0;
      }

      body {
        display: flex;
        flex-direction: column;
        background: #f4f4f4;
      }

      header {
        position: relative;
        min-height: 50px;
      }

      main {
        flex: 1;
        padding: 20px;
      }

      /* Блок з кнопками Sign in / Sign up / Log out у правому верхньому куті */
      .auth-buttons {
        position: fixed;
        top: 10px;
        right: 20px;
        z-index: 1000;
      }

      .auth-buttons a,
      .auth-buttons button {
        margin-left: 8px;
        padding: 6px 12px;
        font-size: 14px;
        border-radius: 4px;
        border: 1px solid rgb(56,56,55);
        background: #ffffff;
        color: rgb(56,56,55);
        text-decoration: none;
        cursor: pointer;
      }

      .auth-buttons button {
        border-color: #c00;
        color: #c00;
      }

      .auth-buttons a:hover,
      .auth-buttons button:hover {
        opacity: 0.9;
      }

      /* Привітання + панель акаунта */
      .welcome-text {
        font-size: 18px;
        margin-bottom: 10px;
        font-weight: 600;
      }

      .user-panel {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 10px 14px;
        border-radius: 10px;
        background: #ffffff;
        box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        margin-bottom: 20px;
        max-width: 320px;
      }

      .user-avatar {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        object-fit: cover;
      }

      /* Картинка гри */
      .main-logo {
        max-width: 60%;
        border-radius: 20px;
        display: block;
        margin-bottom: 20px;
      }

      /* Сніг (сині сніжинки) */
      .snowflake {
        position: fixed;
        top: -10px;
        color: #66c7ff;
        font-size: 14px;
        pointer-events: none;
        z-index: 200;
        animation-name: snow-fall;
        animation-timing-function: linear;
        animation-iteration-count: 1;
        text-shadow: 0 0 4px rgba(0, 0, 0, 0.35);
      }

      @keyframes snow-fall {
        0% {
          transform: translateY(-10vh);
        }
        100% {
          transform: translateY(110vh);
        }
      }
    </style>
  </head>

  <body>
    <header>
      <!-- Кнопки входу/реєстрації/виходу (правий верхній кут) -->
      <div class="auth-buttons">
        <a href="login.html" id="loginLink">Sign in</a>
        <a href="signup.html" id="signupLink">Sign up</a>
        <button id="logoutBtn" style="display:none;">Log out</button>
      </div>

      <!-- Ліві анімаційні кнопки з твого style.css -->
      <nav>
        <a href="game.html" class="about">Грати!</a>
        <a href="#blog" class="blog">Блог</a>
      </nav>
    </header>

    <main>
      <!-- Привітання + акаунт -->
      <p class="welcome-text" id="welcomeText">Welcome Guest</p>

      <div class="user-panel">
        <img
          src="https://learn.logikaschool.com/uploads/student/4796102/692acc8996fdc.png"
          alt="Аватар"
          class="user-avatar"
        />
        <div>
          <div><strong>Акаунт:</strong></div>
          <div id="userNameDisplay">Гість</div>
        </div>
      </div>

      <!-- Основна картинка гри -->
      <img
        src="https://learn.logikaschool.com/uploads/student/4796102/6929d42d4c366.png"
        alt="PINE Tycoon"
        class="main-logo"
      />

      <p class="inf"></p>
      <p>
        Ласкаво просимо до затишного місця "PINE Tycoon". У цій грі вам потрібно
        рубати дрова та будувати своє власне затишне село!
      </p>
      <p>
        Ця версія гри не фінальна, тому може бути багато багів і гра може змінитися з часом.
      </p>

      <h1 id="blog">БЛОГ</h1>
      <p>Поки що тут пусто... але ми вже працюємо над новими оновленнями ❄</p>
    </main>

    <footer>
      © 2025 PINE Tycoon — бета-версія гри
    </footer>

    <!-- Firebase: Welcome + аватар + кнопки входу/виходу -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js';
      import {
        getAuth,
        onAuthStateChanged,
        signOut
      } from 'https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js';

      const firebaseConfig = {
        apiKey: "AIzaSyDZEwAbFwLQXxlkkmuMKBFof2J3OE02Egs",
        authDomain: "pine-tycoon.firebaseapp.com",
        projectId: "pine-tycoon",
        storageBucket: "pine-tycoon.firebasestorage.app",
        messagingSenderId: "949986190236",
        appId: "1:949986190236:web:4f5d50078326f5c1981e59",
        measurementId: "G-2DY6KSY4G7"
      };

      const app  = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      const welcomeText     = document.getElementById('welcomeText');
      const userNameDisplay = document.getElementById('userNameDisplay');
      const avatarImg       = document.querySelector('.user-avatar');

      const loginLink  = document.getElementById('loginLink');
      const signupLink = document.getElementById('signupLink');
      const logoutBtn  = document.getElementById('logoutBtn');

      const DEFAULT_AVATAR   = "https://learn.logikaschool.com/uploads/student/4796102/692acc8996fdc.png";
      const DAVYD3102_AVATAR = "https://learn.logikaschool.com/uploads/student/4796102/692acfc896c23.png";
      const EXTRA_AVATAR     = "https://learn.logikaschool.com/uploads/student/4796102/692b12eb74937.png";
      const GRIVIELD_AVATAR  = "https://learn.logikaschool.com/uploads/student/4796102/692b1a155937b.png";

      function getAvatarForName(name) {
        const map = {
          "davyd3102": DAVYD3102_AVATAR,
          "3102": EXTRA_AVATAR,
          "Cool dave": EXTRA_AVATAR,
          "davyd": EXTRA_AVATAR,
          "Grivield": GRIVIELD_AVATAR
        };
        return map[name] || DEFAULT_AVATAR;
      }

      // Слухаємо зміну стану авторизації
      onAuthStateChanged(auth, (user) => {
        if (user && user.displayName) {
          const name = user.displayName;
          welcomeText.textContent      = "Welcome " + name;
          userNameDisplay.textContent  = name;
          avatarImg.src = getAvatarForName(name);

          loginLink.style.display  = "inline-block";
          signupLink.style.display = "none";
          logoutBtn.style.display  = "inline-block";
        } else {
          welcomeText.textContent      = "Welcome Guest";
          userNameDisplay.textContent  = "Гість";
          avatarImg.src = DEFAULT_AVATAR;

          loginLink.style.display  = "inline-block";
          signupLink.style.display = "inline-block";
          logoutBtn.style.display  = "none";
        }
      });

      // Вихід
      logoutBtn.addEventListener('click', async () => {
        try {
          await signOut(auth);
        } catch (err) {
          console.error(err);
          alert("Не вдалося вийти: " + err.message);
        }
      });
    </script>

    <!-- Снігопад -->
    <script>
      function createSnowflake() {
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        snowflake.textContent = '❄';

        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.fontSize = (10 + Math.random() * 14) + 'px';
        snowflake.style.opacity = (0.4 + Math.random() * 0.6).toString();
        snowflake.style.animationDuration = (5 + Math.random() * 5) + 's';

        document.body.appendChild(snowflake);

        snowflake.addEventListener('animationend', () => {
          snowflake.remove();
        });
      }

      setInterval(createSnowflake, 200);
    </script>
  </body>
</html>
